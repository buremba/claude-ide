FROM node:20

# Install dependencies and locales
RUN apt-get update && apt-get install -y \
    git \
    curl \
    ca-certificates \
    procps \
    locales \
    asciinema \
    && rm -rf /var/lib/apt/lists/* \
    && sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen \
    && locale-gen

# Install Zellij
ARG ZELLIJ_VERSION=0.43.1
RUN curl -fsSL "https://github.com/zellij-org/zellij/releases/download/v${ZELLIJ_VERSION}/zellij-x86_64-unknown-linux-musl.tar.gz" \
    | tar -xz -C /usr/local/bin zellij

# Set locale environment
ENV LANG=en_US.UTF-8
ENV LC_ALL=en_US.UTF-8
ENV LANGUAGE=en_US:en

# Install Claude Code globally
RUN npm install -g @anthropic-ai/claude-code

# Create non-root user for running agents
RUN useradd -m -s /bin/bash test

# Set up working directory
WORKDIR /workspace

# Default command starts bash
CMD ["bash"]
